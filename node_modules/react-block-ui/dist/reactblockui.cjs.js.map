{"version":3,"file":"reactblockui.cjs.js","sources":["../src/Loader.js","../src/safeActiveElement.js","../src/BlockUi.js"],"sourcesContent":["import React from 'react';\n\nfunction Loader() {\n  return (\n    <div className=\"loading-indicator\">\n      <span className=\"loading-bullet\">&bull;</span>{' '}\n      <span className=\"loading-bullet\">&bull;</span>{' '}\n      <span className=\"loading-bullet\">&bull;</span>\n    </div>\n  );\n}\n\nexport default Loader;\n","// https://gist.github.com/Alex1990/046a6553dc83e22dd6f4\n/**\n * Get the current active element safely.\n * Ref: https://github.com/jquery/jquery-ui/blob/2b84531ae9331f60e4d739fabca6d78abde89ae1/ui/safe-active-element.js\n */\nexport default function safeActiveElement(doc) {\n  doc = doc || document;\n  let activeElement;\n\n  try {\n    activeElement = document.activeElement;\n    if (!activeElement || !activeElement.nodeName) {\n      activeElement = doc.body;\n    }\n  } catch ( error ) {\n    activeElement = doc.body;\n  }\n\n  return activeElement;\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport DefaultLoader from './Loader';\nimport safeActiveElement from './safeActiveElement';\n\nconst defaultProps = {\n  tag: 'div',\n  renderChildren: true,\n  loader: DefaultLoader,\n};\n\nclass BlockUi extends Component {\n  constructor(props) {\n    super(props);\n\n    this.tabbedUpTop = this.tabbedUpTop.bind(this);\n    this.tabbedDownTop = this.tabbedDownTop.bind(this);\n    this.tabbedUpBottom = this.tabbedUpBottom.bind(this);\n    this.tabbedDownBottom = this.tabbedDownBottom.bind(this);\n    this.setHelper = this.setRef.bind(this, 'helper');\n    this.setBlocker = this.setRef.bind(this, 'blocker');\n    this.setTopFocus = this.setRef.bind(this, 'topFocus');\n    this.setContainer = this.setRef.bind(this, 'container');\n    this.setMessageContainer = this.setRef.bind(this, 'messageContainer');\n    this.handleScroll = this.handleScroll.bind(this);\n\n    this.state = { top: '50%' };\n  }\n\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.blocking !== this.props.blocking) {\n      if (nextProps.blocking) {\n        // blocking started\n        if (this.helper && this.helper.parentNode && this.helper.parentNode.contains\n          && this.helper.parentNode.contains(safeActiveElement())) {\n          this.focused = safeActiveElement();\n          // We cannot just blur to remove focus due to IE bug so we must manually move the focus somewhere else.\n          // https://www.tjvantoll.com/2013/08/30/bugs-with-document-activeelement-in-internet-explorer/#blurring-the-body-switches-windows-in-ie9-and-ie10\n          if (this.focused && this.focused !== document.body) {\n            (window.setImmediate || setTimeout)(() => this.topFocus && this.topFocus.focus());\n          }\n        }\n      } else {\n        this.detachListeners();\n        const ae = safeActiveElement();\n        if (this.focused && (!ae || ae === document.body || ae === this.topFocus)) {\n          this.focused.focus();\n          this.focused = null;\n        }\n      }\n    }\n    if (nextProps.keepInView && (nextProps.keepInView !== this.props.keepInView || (nextProps.blocking && nextProps.blocking !== this.props.blocking))) {\n      this.attachListeners();\n      this.keepInView(nextProps);\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachListeners();\n  }\n\n  setRef(name, ref) {\n    this[name] = ref;\n  }\n\n  attachListeners() {\n    window.addEventListener('scroll', this.handleScroll);\n  }\n\n  detachListeners() {\n    window.removeEventListener('scroll', this.handleScroll);\n  }\n\n  blockingTab(e, withShift = false) {\n    // eslint-disable-next-line eqeqeq\n    return this.props.blocking && (e.key === 'Tab' || e.keyCode === 9) && e.shiftKey == withShift;\n  }\n\n  tabbedUpTop(e) {\n    if (this.blockingTab(e)) {\n      this.blocker.focus();\n    }\n  }\n\n  tabbedDownTop(e) {\n    if (this.blockingTab(e)) {\n      e.preventDefault();\n      this.blocker.focus();\n    }\n  }\n\n  tabbedUpBottom(e) {\n    if (this.blockingTab(e, true)) {\n      this.topFocus.focus();\n    }\n  }\n\n  tabbedDownBottom(e) {\n    if (this.blockingTab(e, true)) {\n      e.preventDefault();\n      this.topFocus.focus();\n    }\n  }\n\n  keepInView(props = this.props) {\n    if (props.blocking && props.keepInView && this.container) {\n      const containerBounds = this.container.getBoundingClientRect();\n      const windowHeight = window.innerHeight;\n      if (containerBounds.top > windowHeight || containerBounds.bottom < 0) return;\n      if (containerBounds.top >= 0 && containerBounds.bottom <= windowHeight) {\n        if (this.state.top !== '50%') {\n          this.setState({ top: '50%' });\n        }\n        return;\n      }\n\n      const messageBoundsHeight = this.messageContainer ? this.messageContainer.getBoundingClientRect().height : 0;\n      let top = Math.max(Math.min(windowHeight, containerBounds.bottom) - Math.max(containerBounds.top, 0), messageBoundsHeight) / 2;\n      if (containerBounds.top < 0) {\n        top = Math.min(top - containerBounds.top, containerBounds.height - (messageBoundsHeight / 2));\n      }\n      if (this.state.top !== top) {\n        this.setState({top});\n      }\n\n    }\n  }\n\n  handleScroll() {\n    this.keepInView();\n  }\n\n  render() {\n    const {\n      tag: Tag,\n      blocking,\n      className,\n      children,\n      message,\n      loader: Loader,\n      renderChildren,\n      keepInView,\n      ...attributes\n    } = this.props;\n\n    const classes = blocking ? `block-ui ${className}` : className;\n    const renderChilds = !blocking || renderChildren;\n\n    return (\n      <Tag {...attributes} className={classes} aria-busy={blocking} ref={this.setContainer}>\n        {blocking &&\n        <div tabIndex=\"0\" onKeyUp={this.tabbedUpTop} onKeyDown={this.tabbedDownTop} ref={this.setTopFocus} />}\n        {renderChilds && children}\n        {blocking &&\n        <div className=\"block-ui-container\"\n          tabIndex=\"0\"\n          ref={this.setBlocker}\n          onKeyUp={this.tabbedUpBottom}\n          onKeyDown={this.tabbedDownBottom}\n        >\n          <div className=\"block-ui-overlay\" />\n          <div className=\"block-ui-message-container\"\n            ref={this.setMessageContainer}\n            style={{ top: keepInView ? this.state.top : undefined }}\n          >\n            <div className=\"block-ui-message\">\n              {message}\n              {React.isValidElement(Loader) ? Loader : <Loader />}\n            </div>\n          </div>\n        </div>\n        }\n        <span ref={this.setHelper} />\n      </Tag>\n    );\n  }\n}\n\nBlockUi.propTypes = {\n  blocking: PropTypes.bool,\n  children: PropTypes.node,\n  renderChildren: PropTypes.bool,\n  keepInView: PropTypes.bool,\n  className: PropTypes.string,\n  message: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.node,\n  ]),\n  loader: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.func,\n    PropTypes.node,\n  ]),\n  tag: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.func,\n  ]),\n};\nBlockUi.defaultProps = defaultProps;\n\nexport default BlockUi;\n"],"names":["Loader","React","safeActiveElement","doc","document","activeElement","nodeName","body","error","defaultProps","DefaultLoader","BlockUi","props","tabbedUpTop","bind","tabbedDownTop","tabbedUpBottom","tabbedDownBottom","setHelper","setRef","setBlocker","setTopFocus","setContainer","setMessageContainer","handleScroll","state","top","nextProps","blocking","helper","parentNode","contains","focused","window","setImmediate","setTimeout","topFocus","focus","detachListeners","ae","keepInView","attachListeners","name","ref","addEventListener","removeEventListener","e","withShift","key","keyCode","shiftKey","blockingTab","blocker","preventDefault","container","containerBounds","getBoundingClientRect","windowHeight","innerHeight","bottom","setState","messageBoundsHeight","messageContainer","height","Math","max","min","Tag","tag","className","children","message","loader","renderChildren","attributes","classes","renderChilds","undefined","isValidElement","Component"],"mappings":"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"}